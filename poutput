  Churn  gender  SeniorCitizen Partner Dependents  tenure PhoneService  \
0    No  Female              0     Yes         No       1           No   
1    No    Male              0      No         No      34          Yes   
2   Yes    Male              0      No         No       2          Yes   
3    No    Male              0      No         No      45           No   
4   Yes  Female              0      No         No       2          Yes   

      MultipleLines InternetService OnlineSecurity     ...      \
0  No phone service             DSL             No     ...       
1                No             DSL            Yes     ...       
2                No             DSL            Yes     ...       
3  No phone service             DSL            Yes     ...       
4                No     Fiber optic             No     ...       

  DeviceProtection TechSupport StreamingTV StreamingMovies        Contract  \
0               No          No          No              No  Month-to-month   
1              Yes          No          No              No        One year   
2               No          No          No              No  Month-to-month   
3              Yes         Yes          No              No        One year   
4               No          No          No              No  Month-to-month   

  PaperlessBilling              PaymentMethod MonthlyCharges  TotalCharges  \
0              Yes           Electronic check          29.85         29.85   
1               No               Mailed check          56.95       1889.50   
2              Yes               Mailed check          53.85        108.15   
3               No  Bank transfer (automatic)          42.30       1840.75   
4              Yes           Electronic check          70.70        151.65   

   customerID  
0           1  
1           2  
2           3  
3           4  
4           5  

[5 rows x 21 columns]
[   18.8     18.85    19.   ...,  8496.7   8529.5   8564.75]
Churn                object
gender               object
SeniorCitizen         int64
Partner              object
Dependents           object
tenure                int64
PhoneService         object
MultipleLines        object
InternetService      object
OnlineSecurity       object
OnlineBackup         object
DeviceProtection     object
TechSupport          object
StreamingTV          object
StreamingMovies      object
Contract             object
PaperlessBilling     object
PaymentMethod        object
MonthlyCharges      float64
TotalCharges        float64
customerID            int64
dtype: object
   Churn  gender  SeniorCitizen  Partner  Dependents  tenure  PhoneService  \
0      0       0              0        1           0       1             0   
1      0       1              0        0           0      34             1   
2      1       1              0        0           0       2             1   
3      0       1              0        0           0      45             0   
4      1       0              0        0           0       2             1   

   MultipleLines  InternetService  OnlineSecurity     ...      \
0              0                1               0     ...       
1              0                1               1     ...       
2              0                1               1     ...       
3              0                1               1     ...       
4              0                2               0     ...       

   DeviceProtection  TechSupport  StreamingTV  StreamingMovies  Contract  \
0                 0            0            0                0         1   
1                 1            0            0                0         2   
2                 0            0            0                0         1   
3                 1            1            0                0         2   
4                 0            0            0                0         1   

   PaperlessBilling  PaymentMethod  MonthlyCharges  TotalCharges  customerID  
0                 1              3           29.85         29.85           1  
1                 0              4           56.95       1889.50           2  
2                 1              4           53.85        108.15           3  
3                 0              1           42.30       1840.75           4  
4                 1              3           70.70        151.65           5  

[5 rows x 21 columns]
Churn                 int64
gender                int64
SeniorCitizen         int64
Partner               int64
Dependents            int64
tenure                int64
PhoneService          int64
MultipleLines         int64
InternetService       int64
OnlineSecurity        int64
OnlineBackup          int64
DeviceProtection      int64
TechSupport           int64
StreamingTV           int64
StreamingMovies       int64
Contract              int64
PaperlessBilling      int64
PaymentMethod         int64
MonthlyCharges      float64
TotalCharges        float64
customerID            int64
dtype: object
False
Feature space holds 3000 observations and 21 features
Unique target labels: [0 1]
Support vector machines:
1.000
Random forest:
0.998
K-nearest-neighbors:
0.986
   pred_prob  count  true_prob
0        0.0   1914        0.0
1        1.0    504        1.0
2        0.1    268        0.0
3        0.9    190        1.0
4        0.8     65        1.0
5        0.2     35        0.0
6        0.7     17        1.0
7        0.6      4        1.0
8        0.3      3        0.0
     Churn  gender  SeniorCitizen Partner Dependents  tenure PhoneService  \
2993    No    Male              0     Yes        Yes       1          Yes   
986     No  Female              0      No         No      12          Yes   
959     No  Female              0     Yes        Yes      32          Yes   
1275    No  Female              0     Yes         No      55          Yes   
491     No  Female              0      No         No       2          Yes   

     MultipleLines InternetService       OnlineSecurity     ...      \
2993            No              No  No internet service     ...       
986             No             DSL                   No     ...       
959             No     Fiber optic                   No     ...       
1275            No             DSL                  Yes     ...       
491             No             DSL                   No     ...       

         DeviceProtection          TechSupport          StreamingTV  \
2993  No internet service  No internet service  No internet service   
986                    No                   No                   No   
959                    No                   No                  Yes   
1275                   No                  Yes                   No   
491                    No                   No                  Yes   

          StreamingMovies        Contract PaperlessBilling  \
2993  No internet service        One year               No   
986                    No  Month-to-month               No   
959                    No  Month-to-month              Yes   
1275                   No        Two year               No   
491                    No  Month-to-month              Yes   

                  PaymentMethod MonthlyCharges  TotalCharges  customerID  
2993               Mailed check           20.4         20.40        2994  
986   Bank transfer (automatic)           43.8        540.95         987  
959            Electronic check           86.1       2723.75         960  
1275               Mailed check           56.8       3112.05        1276  
491            Electronic check           59.0        114.15         492  

[5 rows x 21 columns]
      Churn  gender  SeniorCitizen  Partner  Dependents  tenure  PhoneService  \
2993      0       1              0        1           1       1             1   
986       0       0              0        0           0      12             1   
959       0       0              0        1           1      32             1   
1275      0       0              0        1           0      55             1   
491       0       0              0        0           0       2             1   

      MultipleLines  InternetService  OnlineSecurity     ...      \
2993              0                0               0     ...       
986               0                1               0     ...       
959               0                2               0     ...       
1275              0                1               1     ...       
491               0                1               0     ...       

      DeviceProtection  TechSupport  StreamingTV  StreamingMovies  Contract  \
2993                 0            0            0                0         2   
986                  0            0            0                0         1   
959                  0            0            1                0         1   
1275                 0            1            0                0         3   
491                  0            0            1                0         1   

      PaperlessBilling  PaymentMethod  MonthlyCharges  TotalCharges  \
2993                 0              4            20.4         20.40   
986                  0              1            43.8        540.95   
959                  1              3            86.1       2723.75   
1275                 0              4            56.8       3112.05   
491                  1              3            59.0        114.15   

      customerID  
2993        2994  
986          987  
959          960  
1275        1276  
491          492  

[5 rows x 21 columns]
Churn                 int64
gender                int64
SeniorCitizen         int64
Partner               int64
Dependents            int64
tenure                int64
PhoneService          int64
MultipleLines         int64
InternetService       int64
OnlineSecurity        int64
OnlineBackup          int64
DeviceProtection      int64
TechSupport           int64
StreamingTV           int64
StreamingMovies       int64
Contract              int64
PaperlessBilling      int64
PaymentMethod         int64
MonthlyCharges      float64
TotalCharges        float64
customerID            int64
dtype: object
2993    2994
986      987
959      960
1275    1276
491      492
2602    2603
398      399
1522    1523
1375    1376
2010    2011
1653    1654
699      700
1174    1175
1124    1125
2624    2625
2543    2544
167      168
1712    1713
922      923
2786    2787
2746    2747
214      215
1038    1039
1361    1362
1133    1134
568      569
2568    2569
1307    1308
1189    1190
29        30
        ... 
1705    1706
1182    1183
44        45
1286    1287
2731    2732
1344    1345
811      812
567      568
1908    1909
2156    2157
2597    2598
2773    2774
1157    1158
2112    2113
2426    2427
2321    2322
726      727
1955    1956
1569    1570
2234    2235
2434    2435
709      710
1613    1614
476      477
1071    1072
2464    2465
1456    1457
1936    1937
1224    1225
2521    2522
Name: customerID, dtype: int64
[[  9.99019864e-01   9.80136206e-04]
 [  9.99647557e-01   3.52442604e-04]
 [  9.99608386e-01   3.91613732e-04]
 ..., 
 [  9.99579598e-01   4.20401951e-04]
 [  8.72113559e-07   9.99999128e-01]
 [  1.13331235e-06   9.99998867e-01]]
Churn               int64
customerID          int64
churn_prob        float64
customer_worth    float64
dtype: object
      Churn  customerID  churn_prob  customer_worth
2993      0        2994    0.000980           20.40
986       0         987    0.000352          540.95
959       0         960    0.000392         2723.75
1275      0        1276    0.000669         3112.05
491       0         492    0.000481          114.15
